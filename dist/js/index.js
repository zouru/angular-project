angular.module("app",["ui.router","validation","validation.rule","ngAnimate"]),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("main",{url:"/main",templateUrl:"view/main.html",controller:"mainCtrl"}).state("search",{url:"/search",templateUrl:"view/search.html",controller:"searchCtrl"}).state("my",{url:"/my",templateUrl:"view/my.html",controller:"myCtrl"}).state("position",{url:"/position/:id",templateUrl:"view/positionDetail.html",controller:"positionDetailCtrl"}).state("company",{url:"/company/:cid",templateUrl:"view/companyDetail.html",controller:"companyDetailCtrl"}).state("login",{url:"/login",templateUrl:"view/login.html",controller:"loginCtrl",replace:!0}).state("myInfo",{url:"/myInfo",templateUrl:"view/myInfo.html",controller:"myInfoCtrl",replace:!0}).state("dilivered",{url:"/dilivered",templateUrl:"view/dilivered.html",controller:"diliveredCtrl",replace:!0}),t.otherwise("main")}]),angular.module("app").config(["$qProvider",function(e){e.errorOnUnhandledRejections(!1)}]),angular.module("app").config(["$validationProvider",function(e){var t={phone:/^1[\d]{10}$/,password:function(e){return e+="",e.length>5}},o={phone:{success:"",error:"必须是11位手机号"},password:{success:"",error:"长度至少6位"}};e.setExpression(t).setDefaultMsg(o)}]),angular.module("app").controller("companyDetailCtrl",["$scope","$state","companyService",function(e,t,o){var n=t.params.cid;o.findById(n).then(function(t){e.company=t,e.nowIndex=0,e.changeList=function(o){e.jobList=t.positionClass[o].positionList,e.nowIndex=o},e.changeList(0),console.log(e.company,888)})}]),angular.module("app").controller("diliveredCtrl",["$scope","dileveredService",function(e,t){t.all().then(function(t){e.positionList=t})}]),angular.module("app").controller("loginCtrl",["$scope","$state",function(e,t){e.submit=function(){localStorage.setItem("userId",1),t.go("myInfo")}}]),angular.module("app").controller("mainCtrl",["$scope","positionService",function(e,t){t.all().then(function(t){e.positionList=t})}]),angular.module("app").controller("myCtrl",["$scope",function(e){}]),angular.module("app").controller("myInfoCtrl",["$scope","$state",function(e,t){e.logout=function(){localStorage.removeItem("userId"),t.go("my")}}]),angular.module("app").controller("positionDetailCtrl",["$scope","$state","positionService","companyService",function(e,t,o,n){var r=t.params.id;o.findById(r).then(function(t){e.job=t,n.findById(t.companyId).then(function(t){e.company=t,console.log(e.company,888)})})}]),angular.module("app").controller("searchCtrl",["$filter","keywordsService","$scope","positionService","cityService",function(e,t,o,n,r){o.keywordsList=JSON.parse(localStorage.getItem("keywordsList")),o.showCitys=function(){o.isCitysShow=!0,o.isLeftShow=!1},o.$on("closeCitys",function(e,t){o.isLeftShow=!1,o.isCitysShow=!1}),n.all().then(function(e){}),o.$on("sendCityId",function(e,t){var n=t.id;o.nowId=n,o.isLeftShow=!1,o.isCitysShow=!1,r.findById(n).then(function(e){o.city=e.name,o.search()})}),o.search=function(){if(o.keywords){var r={city:o.city,keywords:o.keywords};n.all().then(function(n){var n=e("jobFilter")(n,r);if(o.positionList=n,0==n.length)o.keywords="";else{var i=t.get("keywordsList");i.indexOf(o.keywords)>-1||i.push(o.keywords),o.keywordsList=i,t.set("keywordsList",i)}console.log(n,"filter")})}},o.$on("removeKeywords",function(e,n){o.keywordsList.splice(n.index,1),t.set("keywordsList",o.keywordsList)}),o.$on("oldSearch",function(e,t){o.keywords=t,o.search()})}]),angular.module("app").directive("appCitys",[function(){return{restrict:"E",templateUrl:"./view/template/appCitys.html",replace:!0,scope:{nowId:"@"},controller:["$scope","$http",function(e,t){t.get("data/citys.json").then(function(t){e.citys=t.data}),e.changeCity=function(t){e.$emit("sendCityId",{id:t})}}]}}]),angular.module("app").directive("companyInfo",[function(){return{restrict:"E",templateUrl:"./view/template/companyInfo.html",replace:!0,scope:{data:"="}}}]),angular.module("app").directive("appFooter",[function(){return{restrict:"E",templateUrl:"./view/template/footer.html",replace:!0,scope:{},controller:["$scope",function(e){e.isLogin=localStorage.getItem("userId")}]}}]),angular.module("app").directive("fourButton",[function(){return{restrict:"E",templateUrl:"./view/template/fourButton.html",replace:!0}}]),angular.module("app").directive("headBar",[function(){return{restrict:"E",templateUrl:"./view/template/headBar.html",replace:!0,scope:{isLeftShow:"=",title:"@",fade:"@"},controller:["$scope",function(e){e.back=function(){e.fade?e.$emit("closeCitys",{}):window.history.back()}}]}}]),angular.module("app").directive("appHeader",[function(){return{restrict:"E",replace:!0,templateUrl:"view/template/header.html"}}]),angular.module("app").directive("positionInfo",[function(){return{restrict:"E",replace:!0,templateUrl:"view/template/positionInfo.html",scope:{data:"="}}}]),angular.module("app").directive("appPositionList",[function(){return{restrict:"E",replace:!0,templateUrl:"view/template/position.html",scope:{data:"="}}}]),angular.module("app").directive("yuKeywords",[function(){return{restrict:"E",templateUrl:"./view/template/keywords.html",replace:!0,scope:{data:"="},controller:["$scope",function(e){e.removeKeywords=function(t){e.$emit("removeKeywords",{index:t})},e.changeKeywords=function(t){console.log(t,"keywords"),e.$emit("oldSearch",t)}}]}}]),angular.module("app").filter("jobFilter",function(){return function(e,t){for(var o=[],n=0;n<e.length;n++){var r=e[n],i=new RegExp(t.keywords).test(r.companyName)||new RegExp(t.keywords).test(r.job);t.city?i&&r.cityName==t.city&&o.push(r):i&&o.push(r)}return o}}),angular.module("app").service("cityService",["$http",function(e){this.all=function(){return e({url:"../data/citys.json",method:"get",cache:!0}).then(function(e){return e.data})},this.findById=function(e){return this.all().then(function(t){console.log(t);for(var o=0;o<t.length;o++)if(t[o].id===e)return t[o]})}}]),angular.module("app").service("companyService",["$http",function(e){this.all=function(){return e({url:"../data/company.json",method:"get",cache:!0}).then(function(e){return e.data})},this.findById=function(e){return this.all().then(function(t){console.log(t);for(var o=0;o<t.length;o++)if(t[o].id===e)return t[o]})}}]),angular.module("app").service("dileveredService",["$http",function(e){this.all=function(){return e({url:"../data/dilivered.json",method:"get",cache:!0}).then(function(e){return e.data})},this.findById=function(e){return this.all().then(function(t){console.log(t);for(var o=0;o<t.length;o++)if(t[o].id===e)return t[o]})}}]),angular.module("app").service("keywordsService",[function(){this.get=function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):[]},this.set=function(e,t){"string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t))}}]),angular.module("app").service("positionService",["$http",function(e){this.all=function(){return e({url:"../data/positionList.json",method:"get",cache:!0}).then(function(e){return e.data})},this.findById=function(e){return this.all().then(function(t){console.log(t);for(var o=0;o<t.length;o++)if(t[o].id===e)return t[o]})}}]);